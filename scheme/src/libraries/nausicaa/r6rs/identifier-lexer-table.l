;;; -*- mode: scheme; coding: utf-8 -*-
;;;
;;;Part of: Nausicaa/Scheme
;;;Contents: character lexer
;;;Date: Tue Jan  4, 2011
;;;
;;;Abstract
;;;
;;;	This  table defines a  lexer for  Scheme identifiers  defined by
;;;	R6RS.
;;;
;;;Copyright (c) 2011 Marco Maggi <marco.maggi-ipsu@poste.it>
;;;
;;;This program is free software:  you can redistribute it and/or modify
;;;it under the terms of the  GNU General Public License as published by
;;;the Free Software Foundation, either version 3 of the License, or (at
;;;your option) any later version.
;;;
;;;This program is  distributed in the hope that it  will be useful, but
;;;WITHOUT  ANY   WARRANTY;  without   even  the  implied   warranty  of
;;;MERCHANTABILITY  or FITNESS FOR  A PARTICULAR  PURPOSE.  See  the GNU
;;;General Public License for more details.
;;;
;;;You should  have received  a copy of  the GNU General  Public License
;;;along with this program.  If not, see <http://www.gnu.org/licenses/>.
;;;

;;Characters with Unicode category Nd, Mc, Me:
;;(http://www.fileformat.info/info/unicode/category/index.htm)
;;
CHARS-ND	[\48\49\50\51\52\53\54\55\56\57\1632\1633\1634\1635\1636\1637\1638\1639\1640\1641\1776\1777\1778\1779\1780\1781\1782\1783\1784\1785\1984\1985\1986\1987\1988\1989\1990\1991\1992\1993\2406\2407\2408\2409\2410\2411\2412\2413\2414\2415\2534\2535\2536\2537\2538\2539\2540\2541\2542\2543\2662\2663\2664\2665\2666\2667\2668\2669\2670\2671\2790\2791\2792\2793\2794\2795\2796\2797\2798\2799\2918\2919\2920\2921\2922\2923\2924\2925\2926\2927\3046\3047\3048\3049\3050\3051\3052\3053\3054\3055\3174\3175\3176\3177\3178\3179\3180\3181\3182\3183\3302\3303\3304\3305\3306\3307\3308\3309\3310\3311\3430\3431\3432\3433\3434\3435\3436\3437\3438\3439\3664\3665\3666\3667\3668\3669\3670\3671\3672\3673\3792\3793\3794\3795\3796\3797\3798\3799\3800\3801\3872\3873\3874\3875\3876\3877\3878\3879\3880\3881\4160\4161\4162\4163\4164\4165\4166\4167\4168\4169\4240\4241\4242\4243\4244\4245\4246\4247\4248\4249\6112\6113\6114\6115\6116\6117\6118\6119\6120\6121\6160\6161\6162\6163\6164\6165\6166\6167\6168\6169\6470\6471\6472\6473\6474\6475\6476\6477\6478\6479\6608\6609\6610\6611\6612\6613\6614\6615\6616\6617\6784\6785\6786\6787\6788\6789\6790\6791\6792\6793\6800\6801\6802\6803\6804\6805\6806\6807\6808\6809\6992\6993\6994\6995\6996\6997\6998\6999\7000\7001\7088\7089\7090\7091\7092\7093\7094\7095\7096\7097\7232\7233\7234\7235\7236\7237\7238\7239\7240\7241\7248\7249\7250\7251\7252\7253\7254\7255\7256\7257\42528\42529\42530\42531\42532\42533\42534\42535\42536\42537\43216\43217\43218\43219\43220\43221\43222\43223\43224\43225\43264\43265\43266\43267\43268\43269\43270\43271\43272\43273\43472\43473\43474\43475\43476\43477\43478\43479\43480\43481\43600\43601\43602\43603\43604\43605\43606\43607\43608\43609\44016\44017\44018\44019\44020\44021\44022\44023\44024\44025\65296\65297\65298\65299\65300\65301\65302\65303\65304\65305\66720\66721\66722\66723\66724\66725\66726\66727\66728\66729\69734\69735\69736\69737\69738\69739\69740\69741\69742\69743\120782\120783\120784\120785\120786\120787\120788\120789\120790\120791\120792\120793\120794\120795\120796\120797\120798\120799\120800\120801\120802\120803\120804\120805\120806\120807\120808\120809\120810\120811\120812\120813\120814\120815\120816\120817\120818\120819\120820\120821\120822\120823\120824\120825\120826\120827\120828\120829\120830\120831]

CHARS-MC	[\2307\2363\2366\2367\2368\2377\2378\2379\2380\2382\2383\2434\2435\2494\2495\2496\2503\2504\2507\2508\2519\2563\2622\2623\2624\2691\2750\2751\2752\2761\2763\2764\2818\2819\2878\2880\2887\2888\2891\2892\2903\3006\3007\3009\3010\3014\3015\3016\3018\3019\3020\3031\3073\3074\3075\3137\3138\3139\3140\3202\3203\3262\3264\3265\3266\3267\3268\3271\3272\3274\3275\3285\3286\3330\3331\3390\3391\3392\3398\3399\3400\3402\3403\3404\3415\3458\3459\3535\3536\3537\3544\3545\3546\3547\3548\3549\3550\3551\3570\3571\3902\3903\3967\4139\4140\4145\4152\4155\4156\4182\4183\4194\4195\4196\4199\4200\4201\4202\4203\4204\4205\4227\4228\4231\4232\4233\4234\4235\4236\4239\4250\4251\4252\6070\6078\6079\6080\6081\6082\6083\6084\6085\6087\6088\6435\6436\6437\6438\6441\6442\6443\6448\6449\6451\6452\6453\6454\6455\6456\6576\6577\6578\6579\6580\6581\6582\6583\6584\6585\6586\6587\6588\6589\6590\6591\6592\6600\6601\6681\6682\6683\6741\6743\6753\6755\6756\6765\6766\6767\6768\6769\6770\6916\6965\6971\6973\6974\6975\6976\6977\6979\6980\7042\7073\7078\7079\7082\7143\7146\7147\7148\7150\7154\7155\7204\7205\7206\7207\7208\7209\7210\7211\7220\7221\7393\7410\43043\43044\43047\43136\43137\43188\43189\43190\43191\43192\43193\43194\43195\43196\43197\43198\43199\43200\43201\43202\43203\43346\43347\43395\43444\43445\43450\43451\43453\43454\43455\43456\43567\43568\43571\43572\43597\43643\44003\44004\44006\44007\44009\44010\44012\69632\69634\69762\69808\69809\69810\69815\69816\119141\119142\119149\119150\119151\119152\119153\119154]

CHARS-ME	[\1160\1161\8413\8414\8415\8416\8418\8419\8420\42608\42609\42610]
CHARS-ND-MC-ME	{CHARS-ND}|{CHARS-MC}|{CHARS-ME}

LETTER			[a-zA-Z]
CONSTITUENT		{LETTER}|[\127-\55295]|[\57344-\1114111]
SPECIAL_INITIAL		[!\$%&\*/:<=>\?\^_~]
DIGIT			[0-9]
HEXDIGIT		{DIGIT}|[a-fA-F]
SPECIAL_SUBSEQUENT	[\+\-\.@]
HEX_SCALAR_VALUE	{HEXDIGIT}+
INLINE_HEX_ESCAPE	\\x{HEX_SCALAR_VALUE}\;
INITIAL			{CONSTITUENT}|{SPECIAL_INITIAL}|{INLINE_HEX_ESCAPE}
SUBSEQUENT		{INITIAL}|{DIGIT}|{CHARS-ND-MC-ME}|{SPECIAL_SUBSEQUENT}
IDENTIFIER		{INITIAL}{SUBSEQUENT}*
PECULIAR_IDENTIFIER	[\+\-]|"..."|(\->{SUBSEQUENT}*)

;;When a valid lexeme is followed by this tail it is wrong.  This is the
;;negation of the <delimiter> element.
TAIL_OF_WRONG		[^\9\10\11\12\13\32\160\5760\6158\8192\8193\8194\8195\8196\8197\8198\8199\8200\8201\8202\8239\8287\12288\8232\8233\(\)\[\]\"\;#]+

WRONG_IDENTIFIER	{IDENTIFIER}{TAIL_OF_WRONG}

;;We do not include the peculiar  identifiers "+" and "-" here, else the
;;numbers  starting  with  +  and   -  would  be  interpreted  as  wrong
;;identifiers.
;;
WRONG_PECULIAR_IDENTIFIER	("..."|(\->{SUBSEQUENT}*)){TAIL_OF_WRONG}


%%

{IDENTIFIER}		(string->symbol yytext)
{PECULIAR_IDENTIFIER}	(string->symbol yytext)

{WRONG_IDENTIFIER}	(silex-default-error-handler yytext)
{WRONG_PECULIAR_IDENTIFIER}	(silex-default-error-handler yytext)

<<EOF>>			(silex-default-eof-handler)
<<ERROR>>		(silex-default-error-handler)

;;; end of file
